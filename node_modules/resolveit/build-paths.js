var path = require('path'),
    explode = require('./explode'),
    _ = require('underscore'),
    join = path.join.bind(path),
    normalize = path.normalize.bind(path),
    PATH_SEP = path.sep,
    CACHE = require('./cache');

function toArray (val) {
    return _.isArray(val) ?
        val :
        typeof val !== 'undefined' ? [val] : [];
}

function buildPaths (search, opts) {
    if (search.indexOf(PATH_SEP) === 0) {
        return [search];
    }

    return _.
        chain(toArray(opts.basedir)).
        map(explode).
        map(function (dir) {
            return opts.prefix ?
                [dir].concat(toArray(opts.prefix)).
                    map(function (prefix) {
                        return join(dir, prefix);
                    });
        }).
}

module.exports = buildPaths;
